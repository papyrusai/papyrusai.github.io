<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
  />
  <title>Profile Cuatrecasas</title>
  <link rel="icon" href="assets/papyrus_logo.png" type="image/png">
  <link rel="stylesheet" href="https://api.fontshare.com/v2/css?f[]=satoshi@400,500,600,700&display=swap">
  <link rel="stylesheet" type="text/css" href="styles/styles.css" />
  <link rel="stylesheet" type="text/css" href="styles/menu.css" />
  <link rel="stylesheet" type="text/css" href="styles/toggle.css" />
  <link rel="stylesheet" type="text/css" href="styles/dropdown.css" />
  <link rel="stylesheet" type="text/css" href="styles/radio_menu.css" />
  <link rel="stylesheet" type="text/css" href="styles/mobile.css" />
  <style>
    /* Additional styles for dropdowns */
    #serviciosDropdown,
    #tipoDropdown,
    #rangoDropdown {
      max-height: 200px;
      overflow-y: auto;
      position: absolute;
      z-index: 1000;
      background: #fff;
      border: 1px solid #ccc;
      padding: 5px;
    }
    #serviciosDropdown .dropdown-bottom,
    #tipoDropdown .dropdown-bottom,
    #rangoDropdown .dropdown-bottom {
      text-align: center;
      padding: 5px;
      border-top: 1px solid #ccc;
      cursor: pointer;
    }

    .dropdown {
      position: relative;
      display: inline-block;
    }

    /* Boletín Oficial: only BOE selectable (others are dimmed) */
    .filter-options input[type="checkbox"]:not([value="BOE"]) {
      opacity: 0.5;
      pointer-events: none;
    }

    /* Make the dropdown labels smaller font, with border bottom as separator */
    .dropdown-content label {
      display: block;
      padding: 4px 2px;
      margin: 0;
      cursor: pointer;
      font-size: 0.85em;
      border-bottom: 1px solid #ddd;
    }
    .dropdown-content label:last-child {
      border-bottom: none;
    }

    /* "Todos" label in bold */
    label.todos-label {
      font-weight: bold;
    }

    /* Make checkboxes smaller + green accent color (#83a300) when checked */
    .dropdown-content input[type="checkbox"] {
      width: 16px;
      height: 16px;
      transform: scale(0.9);
      accent-color: #04db8d; /* Modern browsers */
    }
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="logo">
      <a href="https://www.papyrus-ai.com/" target="_blank">
        <img src="assets/papyrus_app.png" alt="Papyrus Logo" style="height: 55px;">
      </a>
    </div>
    <button class="hamburger" onclick="toggleMenu()">☰</button>
    <ul class="menu">
      <li><a href="https://papyrus-ai.com/">WEB</a></li>
      <li><a href="/profile_cuatrecasas">PANEL DE CONTROL</a></li>
      <li><a href="http://app.papyrus-ai.com/suscripcion.html">EDITAR SUSCRIPCIÓN</a></li>
      <li><a href="https://papyrus-ai.com/pages/contact-1">AYUDA</a></li>
    </ul>
  </nav>

  <!-- Profile Header with Cuatrecasas logo -->
  <div class="profile-header" style="display: flex; align-items: center; gap: 15px; margin: 20px;">
    <img src="assets/cuatrecasas_logo.png" alt="Cuatrecasas Logo" style="height: 160px;">
  </div>

  <h1>Resumen diario Boletines Oficiales</h1>
  <div id="data-container">
    <!-- Filter Section -->
    <div id="Filtrar">
      <!-- Servicios Cuatrecasas Dropdown -->
      <div class="filter-item">
        <div class="etiquetas-label">Servicios Cuatrecasas</div>
        <div class="dropdown" style="margin-bottom: 10px;">
          <button onclick="toggleServiciosDropdown()" class="dropbtn">
            <span id="selectedServicio">Todos</span>
            <i class="fa fa-caret-down"></i>
          </button>
          <div id="serviciosDropdown" class="dropdown-content">
            <!-- "Todos" is a special checkbox that toggles all -->
            <label class="todos-label">
              <input type="checkbox" value="Todos" id="chkTodos" onclick="toggleAllServicios()">
              Todos
            </label>
            <label><input type="checkbox" value="Arbitraje Internacional" onclick="updateSelectedServicios()">Arbitraje Internacional</label>
            <label><input type="checkbox" value="Competencia" onclick="updateSelectedServicios()">Competencia</label>
            <label><input type="checkbox" value="Deporte y Entretenimiento" onclick="updateSelectedServicios()">Deporte y Entretenimiento</label>
            <label><input type="checkbox" value="Empresa y Derechos Humanos" onclick="updateSelectedServicios()">Empresa y Derechos Humanos</label>
            <label><input type="checkbox" value="Energía e Infraestructura - Energías Renovables" onclick="updateSelectedServicios()">Energía e Infraestructura - Energías Renovables</label>
            <label><input type="checkbox" value="Energía e Infraestructura - Petróleo, Gas y Minería" onclick="updateSelectedServicios()">Energía e Infraestructura - Petróleo, Gas y Minería</label>
            <label><input type="checkbox" value="Energía e Infraestructura - Infraestructuras" onclick="updateSelectedServicios()">Energía e Infraestructura - Infraestructuras</label>
            <label><input type="checkbox" value="Farmacéutico y Sanitario" onclick="updateSelectedServicios()">Farmacéutico y Sanitario</label>
            <label><input type="checkbox" value="Financiero" onclick="updateSelectedServicios()">Financiero</label>
            <label><input type="checkbox" value="Fiscalidad Contenciosa" onclick="updateSelectedServicios()">Fiscalidad Contenciosa</label>
            <label><input type="checkbox" value="Fiscalidad Corporativa" onclick="updateSelectedServicios()">Fiscalidad Corporativa</label>
            <label><input type="checkbox" value="Fiscalidad Financiera" onclick="updateSelectedServicios()">Fiscalidad Financiera</label>
            <label><input type="checkbox" value="Fiscalidad Indirecta" onclick="updateSelectedServicios()">Fiscalidad Indirecta</label>
            <label><input type="checkbox" value="Fondos" onclick="updateSelectedServicios()">Fondos</label>
            <label><input type="checkbox" value="Gobierno Corporativo y Compliance" onclick="updateSelectedServicios()">Gobierno Corporativo y Compliance</label>
            <label><input type="checkbox" value="Inmobiliario y Urbanismo" onclick="updateSelectedServicios()">Inmobiliario y Urbanismo</label>
            <label><input type="checkbox" value="Laboral" onclick="updateSelectedServicios()">Laboral</label>
            <label><input type="checkbox" value="Litigación - Conflictos Societarios y de M&A" onclick="updateSelectedServicios()">Litigación - Conflictos Societarios y de M&A</label>
            <label><input type="checkbox" value="Litigación - Litigación de Construcción e Inmobiliaria" onclick="updateSelectedServicios()">Litigación - Litigación de Construcción e Inmobiliaria</label>
            <label><input type="checkbox" value="Litigación - Litigación a Gran Escala" onclick="updateSelectedServicios()">Litigación - Litigación a Gran Escala</label>
            <label><input type="checkbox" value="Mercado de Capitales - Equity" onclick="updateSelectedServicios()">Mercado de Capitales - Equity</label>
            <label><input type="checkbox" value="Mercado de Capitales - Debt" onclick="updateSelectedServicios()">Mercado de Capitales - Debt</label>
            <label><input type="checkbox" value="Mercantil y M&A" onclick="updateSelectedServicios()">Mercantil y M&A</label>
            <label><input type="checkbox" value="Penal - Compliance Penal" onclick="updateSelectedServicios()">Penal - Compliance Penal</label>
            <label><input type="checkbox" value="Penal - Derecho Penal Económico" onclick="updateSelectedServicios()">Penal - Derecho Penal Económico</label>
            <label><input type="checkbox" value="Precios de Transferencia y Tax Governance" onclick="updateSelectedServicios()">Precios de Transferencia y Tax Governance</label>
            <label><input type="checkbox" value="Private Client & Wealth Management" onclick="updateSelectedServicios()">Private Client & Wealth Management</label>
            <label><input type="checkbox" value="Private Equity" onclick="updateSelectedServicios()">Private Equity</label>
            <label><input type="checkbox" value="Propiedad Intelectual, Industrial y Secretos" onclick="updateSelectedServicios()">Propiedad Intelectual, Industrial y Secretos</label>
            <label><input type="checkbox" value="Protección de Datos" onclick="updateSelectedServicios()">Protección de Datos</label>
            <label><input type="checkbox" value="Público - Contratación Pública" onclick="updateSelectedServicios()">Público - Contratación Pública</label>
            <label><input type="checkbox" value="Público - Medioambiente y Cambio Climático" onclick="updateSelectedServicios()">Público - Medioambiente y Cambio Climático</label>
            <label><input type="checkbox" value="Público - Sectores Regulados" onclick="updateSelectedServicios()">Público - Sectores Regulados</label>
            <label><input type="checkbox" value="Reestructuraciones, Insolvencias y Situaciones Especiales - Refinanciación y Reestructuración de Deuda" onclick="updateSelectedServicios()">Reestructuraciones, Insolvencias y Situaciones Especiales - Refinanciación y Reestructuración de Deuda</label>
            <label><input type="checkbox" value="Reestructuraciones, Insolvencias y Situaciones Especiales - Insolvencias y Situaciones Especiales" onclick="updateSelectedServicios()">Reestructuraciones, Insolvencias y Situaciones Especiales - Insolvencias y Situaciones Especiales</label>
            <label><input type="checkbox" value="Servicios Financieros y de Seguros - Corporate y M&A" onclick="updateSelectedServicios()">Servicios Financieros y de Seguros - Corporate y M&A</label>
            <label><input type="checkbox" value="Servicios Financieros y de Seguros - Regulatorio" onclick="updateSelectedServicios()">Servicios Financieros y de Seguros - Regulatorio</label>
            <label><input type="checkbox" value="Tecnologías y Medios Digitales" onclick="updateSelectedServicios()">Tecnologías y Medios Digitales</label>
            <label><input type="checkbox" value="Venture Capital" onclick="updateSelectedServicios()">Venture Capital</label>

            <div class="dropdown-bottom" onclick="toggleServiciosDropdown()">
              <i class="fa fa-caret-down"></i>
            </div>
          </div>
        </div>
      </div>

      <!-- Tipo disposición -->
      <div class="filter-item">
        <div class="etiquetas-label">Tipo disposición</div>
        <div class="dropdown" style="margin-bottom: 10px;">
          <button onclick="toggleTipoDropdown()" class="dropbtn">
            <span id="selectedTipo">Todos</span>
            <i class="fa fa-caret-down"></i>
          </button>
          <div id="tipoDropdown" class="dropdown-content">
            <!-- "Todos" is a special checkbox that toggles all -->
            <label class="todos-label">
              <input type="checkbox" value="Todos" id="chkTodosTipo" onclick="toggleAllTipos()">
              Todos
            </label>
            <label><input type="checkbox" value="Disposiciones generales" onclick="updateSelectedTipos()">Disposiciones generales</label>
            <label><input type="checkbox" value="Otras disposiciones" onclick="updateSelectedTipos()">Otras disposiciones</label>
            <div class="dropdown-bottom" onclick="toggleTipoDropdown()">
              <i class="fa fa-caret-down"></i>
            </div>
          </div>
          
        </div>
      </div>

      <!-- Rango -->
      <div class="filter-item">
        <div class="etiquetas-label">Rango</div>
        <div class="dropdown" style="margin-bottom: 10px;">
          <button onclick="toggleRangoDropdown()" class="dropbtn">
            <span id="selectedRango">Todos</span>
            <i class="fa fa-caret-down"></i>
          </button>
          <div id="rangoDropdown" class="dropdown-content">
            <!-- "Todos" is a special checkbox that toggles all -->
            <label class="todos-label">
              <input type="checkbox" value="Todos" id="chkTodosRango" onclick="toggleAllRangos()">
              Todos
            </label>
            <label><input type="checkbox" value="Legislación" onclick="updateSelectedRangos()">Legislación</label>
            <label><input type="checkbox" value="Normativa Reglamentaria" onclick="updateSelectedRangos()">Normativa Reglamentaria</label>
            <label><input type="checkbox" value="Doctrina Administrativa" onclick="updateSelectedRangos()">Doctrina Administrativa</label>
            <label><input type="checkbox" value="Comunicados, Guías y Directivas de Reguladores" onclick="updateSelectedRangos()">Comunicados, Guías y Directivas de Reguladores</label>
            <label><input type="checkbox" value="Decisiones Judiciales" onclick="updateSelectedRangos()">Decisiones Judiciales</label>
            <label><input type="checkbox" value="Normativa Europea" onclick="updateSelectedRangos()">Normativa Europea</label>
            <label><input type="checkbox" value="Acuerdos Internacionales" onclick="updateSelectedRangos()">Acuerdos Internacionales</label>
            <label><input type="checkbox" value="Anuncios de Concentración de Empresas" onclick="updateSelectedRangos()">Anuncios de Concentración de Empresas</label>
            <label><input type="checkbox" value="Dictámenes y Opiniones Consultivas" onclick="updateSelectedRangos()">Dictámenes y Opiniones Consultivas</label>
            <label><input type="checkbox" value="Consultas públicas" onclick="updateSelectedRangos()">Consultas públicas</label>
            <label><input type="checkbox" value="Borradores Legislativos" onclick="updateSelectedRangos()">Borradores Legislativos</label>
            <label><input type="checkbox" value="Otras" onclick="updateSelectedRangos()">Otras</label>
            <div class="dropdown-bottom" onclick="toggleRangoDropdown()">
              <i class="fa fa-caret-down"></i>
            </div>
          </div>
          
        </div>
      </div>

      <!-- Boletín Oficial (only BOE is selectable) -->
      <div class="filter-item">
        <div class="filter-section">
          <div class="etiquetas-label">Boletín Oficial</div>
          <div class="filter-options">
            <label class="filter-option">
              <input type="checkbox" name="boletin" value="BOE" checked> BOE
            </label>
            <label class="filter-option">
              <input type="checkbox" name="boletin" value="BOCM" disabled> BOCM
            </label>
            <label class="filter-option">
              <input type="checkbox" name="boletin" value="BOA" disabled> BOA
            </label>
            <label class="filter-option">
              <input type="checkbox" name="boletin" value="BOJA" disabled> BOJA
            </label>
            <label class="filter-option">
              <input type="checkbox" name="boletin" value="BOPV" disabled> BOPV
            </label>
            <label class="filter-option">
              <input type="checkbox" name="boletin" value="DOUE" disabled> DOUE
            </label>
          </div>
        </div>
      </div>
    </div>

    <div style="text-align: right;">
      <button id="buscarBtn" onclick="handleBuscar_cuatrecasas()">Buscar</button>
    </div>

    <!-- Documentos Section -->
    <div class="analytics-label">Documentos - Día {{documentDate}}</div>
    <div class="collectionDocs">
      {{boeDocuments}}
    </div>
  </div>

  <div class="logout-container">
    <a href="/logout">Logout</a>
  </div>

  <script>
    // -------------- Menu toggling --------------
    function toggleMenu() {
      const menu = document.querySelector('.menu');
      menu.classList.toggle('active');
    }

    document.addEventListener('click', function(event) {
      // Hide Servicios dropdown if open
      const serviciosDropdown = document.getElementById('serviciosDropdown');
      if (serviciosDropdown && serviciosDropdown.classList.contains('show')
          && !event.target.closest('.dropdown')) {
        serviciosDropdown.classList.remove('show');
      }

      // Hide Tipo dropdown if open
      const tipoDropdown = document.getElementById('tipoDropdown');
      if (tipoDropdown && tipoDropdown.classList.contains('show')
          && !event.target.closest('.dropdown')) {
        tipoDropdown.classList.remove('show');
      }

      // Hide Rango dropdown if open
      const rangoDropdown = document.getElementById('rangoDropdown');
      if (rangoDropdown && rangoDropdown.classList.contains('show')
          && !event.target.closest('.dropdown')) {
        rangoDropdown.classList.remove('show');
      }

      // Hide hamburger menu if clicking outside
      const menu = document.querySelector('.menu');
      const hamburger = document.querySelector('.hamburger');
      if (!menu.contains(event.target) && !hamburger.contains(event.target)) {
        menu.classList.remove('active');
      }
    });

    // -------------- Dropdown toggles --------------
    function toggleServiciosDropdown() {
      const dropdown = document.getElementById('serviciosDropdown');
      dropdown.classList.toggle('show');
    }
    function toggleTipoDropdown() {
      const dropdown = document.getElementById('tipoDropdown');
      dropdown.classList.toggle('show');
    }
    function toggleRangoDropdown() {
      const dropdown = document.getElementById('rangoDropdown');
      dropdown.classList.toggle('show');
    }

    // -------------- Multi-Select Logic for "Servicios" --------------
    // Called if "Todos" is toggled
    function toggleAllServicios() {
      const chkTodos = document.getElementById('chkTodos');
      const checkboxes = document.querySelectorAll('#serviciosDropdown input[type="checkbox"]:not(#chkTodos)');
      if (chkTodos.checked) {
        // Check everything
        checkboxes.forEach(cb => (cb.checked = true));
      } else {
        // Uncheck everything
        checkboxes.forEach(cb => (cb.checked = false));
      }
      // Then update label
      updateSelectedServicios();
    }

    // Called whenever a single service checkbox is toggled
    function updateSelectedServicios() {
      const checkboxes = document.querySelectorAll('#serviciosDropdown input[type="checkbox"]:not(#chkTodos)');
      const chkTodos = document.getElementById('chkTodos');
      let selectedCount = 0;
      let totalCount = 0;
      let singleSelectedValue = "";

      checkboxes.forEach(cb => {
        totalCount++;
        if (cb.checked) {
          selectedCount++;
          singleSelectedValue = cb.value;
        }
      });

      // If user selected all => set chkTodos
      if (selectedCount === totalCount) {
        chkTodos.checked = true;
      } else {
        chkTodos.checked = false;
      }

      // Update the button label
      const buttonLabel = document.getElementById('selectedServicio');
      if (selectedCount === 0) {
        buttonLabel.textContent = "Ninguno";
      } else if (selectedCount === totalCount) {
        buttonLabel.textContent = "Todos";
      } else if (selectedCount === 1) {
        buttonLabel.textContent = singleSelectedValue;
      } else {
        buttonLabel.textContent = selectedCount + " seleccionados";
      }
    }

    // -------------- Multi-Select Logic for "Tipos" --------------
      function toggleAllTipos() {
        const chkTodosTipo = document.getElementById('chkTodosTipo');
        const checkboxes = document.querySelectorAll('#tipoDropdown input[type="checkbox"]:not(#chkTodosTipo)');
        if (chkTodosTipo.checked) {
          // Check everything
          checkboxes.forEach(cb => (cb.checked = true));
        } else {
          // Uncheck everything
          checkboxes.forEach(cb => (cb.checked = false));
        }
        // Then update label
        updateSelectedTipos();
      }

      function updateSelectedTipos() {
        const checkboxes = document.querySelectorAll('#tipoDropdown input[type="checkbox"]:not(#chkTodosTipo)');
        const chkTodosTipo = document.getElementById('chkTodosTipo');
        let selectedCount = 0;
        let totalCount = 0;
        let singleSelectedValue = "";

        checkboxes.forEach(cb => {
          totalCount++;
          if (cb.checked) {
            selectedCount++;
            singleSelectedValue = cb.value;
          }
        });

        // If user selected all => set chkTodos
        if (selectedCount === totalCount) {
          chkTodosTipo.checked = true;
        } else {
          chkTodosTipo.checked = false;
        }

        // Update the button label
        const buttonLabel = document.getElementById('selectedTipo');
        if (selectedCount === 0) {
          buttonLabel.textContent = "Ninguno";
        } else if (selectedCount === totalCount) {
          buttonLabel.textContent = "Todos";
        } else if (selectedCount === 1) {
          buttonLabel.textContent = singleSelectedValue;
        } else {
          buttonLabel.textContent = selectedCount + " seleccionados";
        }
      }

      // -------------- Multi-Select Logic for "Rangos" --------------
      function toggleAllRangos() {
        const chkTodosRango = document.getElementById('chkTodosRango');
        const checkboxes = document.querySelectorAll('#rangoDropdown input[type="checkbox"]:not(#chkTodosRango)');
        if (chkTodosRango.checked) {
          // Check everything
          checkboxes.forEach(cb => (cb.checked = true));
        } else {
          // Uncheck everything
          checkboxes.forEach(cb => (cb.checked = false));
        }
        // Then update label
        updateSelectedRangos();
      }

      function updateSelectedRangos() {
        const checkboxes = document.querySelectorAll('#rangoDropdown input[type="checkbox"]:not(#chkTodosRango)');
        const chkTodosRango = document.getElementById('chkTodosRango');
        let selectedCount = 0;
        let totalCount = 0;
        let singleSelectedValue = "";

        checkboxes.forEach(cb => {
          totalCount++;
          if (cb.checked) {
            selectedCount++;
            singleSelectedValue = cb.value;
          }
        });

        // If user selected all => set chkTodos
        if (selectedCount === totalCount) {
          chkTodosRango.checked = true;
        } else {
          chkTodosRango.checked = false;
        }

        // Update the button label
        const buttonLabel = document.getElementById('selectedRango');
        if (selectedCount === 0) {
          buttonLabel.textContent = "Ninguno";
        } else if (selectedCount === totalCount) {
          buttonLabel.textContent = "Todos";
        } else if (selectedCount === 1) {
          buttonLabel.textContent = singleSelectedValue;
        } else {
          buttonLabel.textContent = selectedCount + " seleccionados";
        }
      }
      function handleBuscar_cuatrecasas() {
  // 1) Gather the selected services
  const serviceCheckboxes = document.querySelectorAll('#serviciosDropdown input[type="checkbox"]:not(#chkTodos)');
  let selectedServicios = [];
  serviceCheckboxes.forEach(cb => {
    if (cb.checked) {
      selectedServicios.push(cb.value);
    }
  });

  // 2) Gather the selected tipos
  const tipoCheckboxes = document.querySelectorAll('#tipoDropdown input[type="checkbox"]:not(#chkTodosTipo)');
  let selectedTipos = [];
  tipoCheckboxes.forEach(cb => {
    if (cb.checked) {
      selectedTipos.push(cb.value);
    }
  });

  // 3) Gather the selected rangos
  const rangoCheckboxes = document.querySelectorAll('#rangoDropdown input[type="checkbox"]:not(#chkTodosRango)');
  let selectedRangos = [];
  rangoCheckboxes.forEach(cb => {
    if (cb.checked) {
      selectedRangos.push(cb.value);
    }
  });

  // All documents
  const docs = document.querySelectorAll('.collectionDocs .data-item');
  docs.forEach(doc => {
    const etiquetasText = doc.querySelector('.etiquetas-values').innerText;
    const seccionText = doc.querySelector('.doc-seccion')
                      ? doc.querySelector('.doc-seccion').innerText
                      : "";
    const rangoText = doc.querySelector('.doc-rango')
                      ? doc.querySelector('.doc-rango').innerText
                      : "";

    // If 0 selected => show none
    let matchServicio = false;
    if (selectedServicios.length === 0) {
      matchServicio = false;
    } else {
      // Document matches if "etiquetas-values" includes ANY selected service
      for (let s of selectedServicios) {
        if (etiquetasText.includes(s)) {
          matchServicio = true;
          break;
        }
      }
    }

    // Check if document matches any selected tipo
    let matchTipo = false;
    if (selectedTipos.length === 0) {
      matchTipo = false;
    } else {
      for (let t of selectedTipos) {
        if (seccionText.includes(t)) {
          matchTipo = true;
          break;
        }
      }
    }

    // Check if document matches any selected rango
    let matchRango = false;
    if (selectedRangos.length === 0) {
      matchRango = false;
    } else {
      for (let r of selectedRangos) {
        if (rangoText.includes(r)) {
          matchRango = true;
          break;
        }
      }
    }

    if (matchServicio && matchTipo && matchRango) {
      doc.style.display = '';
    } else {
      doc.style.display = 'none';
    }
  });
}


  </script>
</body>
</html>
