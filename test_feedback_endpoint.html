<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Feedback Endpoint</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
        button { padding: 10px 20px; margin: 10px; background: #04db8d; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #03c07a; }
        .results { background: #f5f5f5; padding: 15px; margin: 10px 0; border-radius: 5px; white-space: pre-wrap; font-family: monospace; }
        input, select { padding: 8px; margin: 5px; border: 1px solid #ddd; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>üß™ Test Feedback Endpoint</h1>
    
    <div>
        <h3>Configuraci√≥n de Prueba:</h3>
        <input type="text" id="docId" placeholder="Document ID" value="test-doc-123">
        <select id="feedbackType">
            <option value="like">üëç Like</option>
            <option value="dislike">üëé Dislike</option>
        </select>
        <input type="text" id="agente" placeholder="Agente" value="Test Agent">
        <input type="text" id="coleccion" placeholder="Colecci√≥n" value="TEST">
        <input type="text" id="feedbackDetalle" placeholder="Detalle (para dislike)" value="Test reason">
    </div>

    <button onclick="testEndpoint()">üöÄ Test Feedback Endpoint</button>
    <button onclick="testEndpointStatus()">üìä Test Router Status</button>
    <button onclick="clearResults()">üßπ Clear Results</button>

    <div id="results" class="results">Resultados aparecer√°n aqu√≠...</div>

    <script>
        function log(message) {
            const results = document.getElementById('results');
            const timestamp = new Date().toISOString();
            results.textContent += `[${timestamp}] ${message}\n`;
            console.log(message);
        }

        async function testEndpointStatus() {
            try {
                log('=== TESTING ROUTER STATUS ===');
                
                const response = await fetch('/feedback-test');
                log(`Status: ${response.status}`);
                
                if (response.ok) {
                    const data = await response.json();
                    log(`Response: ${JSON.stringify(data, null, 2)}`);
                } else {
                    const errorText = await response.text();
                    log(`Error: ${errorText}`);
                }
            } catch (error) {
                log(`Exception: ${error.message}`);
            }
        }

        async function testEndpoint() {
            try {
                log('=== TESTING FEEDBACK ENDPOINT ===');
                
                const docId = document.getElementById('docId').value;
                const feedbackType = document.getElementById('feedbackType').value;
                const agente = document.getElementById('agente').value;
                const coleccion = document.getElementById('coleccion').value;
                const feedbackDetalle = document.getElementById('feedbackDetalle').value;
                
                const requestBody = {
                    docId: docId,
                    feedback: feedbackType === 'dislike' ? `dislike: ${feedbackDetalle}` : feedbackType,
                    agenteEtiquetado: agente,
                    coleccion: coleccion,
                    docUrl: 'https://test.com/test.pdf',
                    docTitle: 'Test Document',
                    feedbackDetalle: feedbackType === 'dislike' ? feedbackDetalle : ''
                };
                
                log(`Request body: ${JSON.stringify(requestBody, null, 2)}`);
                
                const response = await fetch('/feedback-thumbs', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestBody)
                });
                
                log(`Response status: ${response.status}`);
                log(`Response ok: ${response.ok}`);
                
                if (response.ok) {
                    const data = await response.json();
                    log(`‚úÖ Success: ${JSON.stringify(data, null, 2)}`);
                } else {
                    const errorText = await response.text();
                    log(`‚ùå Error: ${errorText}`);
                }
                
            } catch (error) {
                log(`üí• Exception: ${error.message}`);
            }
        }

        function clearResults() {
            document.getElementById('results').textContent = '';
        }

        // Test inicial al cargar la p√°gina
        window.onload = function() {
            log('P√°gina de prueba cargada');
            testEndpointStatus();
        };
    </script>
</body>
</html> 